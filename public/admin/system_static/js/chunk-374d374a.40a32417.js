(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-374d374a","chunk-8ccb56cc"],{"0f0e":function(t,e,a){"use strict";a("d81d"),a("4de4"),a("d3b7"),a("a434"),a("14d9"),a("b64b"),a("e9c4");var i=a("c4c8"),s={name:"userLabel",props:{},data:function(){return{labelList:[],dataLabel:[],isUser:!1}},mounted:function(){this.setLabel()},methods:{inArray:function(t,e){for(var a in e)if(e[a].id==t)return!0;return!1},setLabel:function(){var t=this;Object(i.z)().then((function(e){e.data.map((function(e){e.children&&(t.isUser=!0,e.children.map((function(e){t.inArray(e.id,t.dataLabel)?e.disabled=!0:e.disabled=!1})))})),t.labelList=e.data})).catch((function(e){t.$message.error(e.msg)}))},selectLabel:function(t){var e;t.disabled?(e=this.dataLabel.indexOf(this.dataLabel.filter((function(e){return e.id==t.id}))[0]),this.dataLabel.splice(e,1),t.disabled=!1):(this.dataLabel.push({label_name:t.label_name,id:t.id}),t.disabled=!0)},subBtn:function(){this.$emit("activeData",JSON.parse(JSON.stringify(this.dataLabel)))},cancel:function(){this.$emit("close")}}};a("1cf7"),a=a("2877"),a=Object(a.a)(s,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"label-wrapper"},[e("div",{staticClass:"list-box"},[t.isUser?t._l(t.labelList,(function(a,i){return e("div",{key:i,staticClass:"label-box"},[a.children?e("div",{staticClass:"title"},[t._v(t._s(a.label_name))]):t._e(),a.children&&a.children.length?e("div",{staticClass:"list"},t._l(a.children,(function(a,i){return e("div",{key:i,staticClass:"label-item",class:{on:a.disabled},on:{click:function(e){return t.selectLabel(a)}}},[t._v("\n            "+t._s(a.label_name)+"\n          ")])})),0):t._e()])})):t._e(),t.isUser?t._e():e("div",[t._v("暂无标签")])],2),e("div",{staticClass:"footer"},[e("el-button",{staticClass:"btns",attrs:{ghost:""},on:{click:t.cancel}},[t._v("取消")]),e("el-button",{staticClass:"btns",attrs:{type:"primary"},on:{click:t.subBtn}},[t._v("确定")])],1)])}),[],!1,null,"37eb90ed",null);e.a=a.exports},"1cf7":function(t,e,a){"use strict";a("4205")},"220b":function(t,e,a){"use strict";a("94b8")},4205:function(t,e,a){},"7db8":function(t,e,a){},"8c03":function(t,e,a){"use strict";a.r(e);var i=a("c7eb"),s=a("1da1"),r=(a("a15b"),a("d81d"),a("c73d"),a("90e7")),l={name:"index",data:function(){return{formValidate:{page:1,limit:15,data:"",nickname:""},tableList2:[],timeVal:[],fromList:{title:"选择时间",custom:!0,fromTxt:[{text:"全部",val:""},{text:"今天",val:"today"},{text:"昨天",val:"yesterday"},{text:"最近7天",val:"lately7"},{text:"最近30天",val:"lately30"},{text:"本月",val:"month"},{text:"本年",val:"year"}]},currentid:0,productRow:{},loading2:!1,total2:0}},created:function(){},mounted:function(){this.getListService()},methods:{onchangeTime:function(t){this.timeVal=t,this.formValidate.data=this.timeVal?this.timeVal.join("-"):"",this.getListService()},selectChange:function(t){this.formValidate.data=t,this.timeVal=[],this.getListService()},getListService:function(){var t=this;this.loading2=!0,Object(r.G)(this.formValidate).then(function(){var e=Object(s.a)(Object(i.a)().mark((function e(a){var s;return Object(i.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=a.data,t.tableList2=s.list,t.total2=s.count,t.tableList2.map((function(t){t._isChecked=!1})),t.loading2=!1;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){t.loading2=!1,t.$message.error(e.msg)}))},userSearchs:function(){this.formValidate.page=1,this.getListService()},currentidRadio:function(t){self.currentid=t.uid,this.productRow=t,this.productRow.uid?"image"===this.$route.query.fodder?(t={image:this.productRow.headimgurl,uid:this.productRow.uid},form_create_helper.set("image",t),form_create_helper.close("image")):this.$emit("imageObject",{image:this.productRow.headimgurl,uid:this.productRow.uid}):this.$message.warning("请先选择商品")}}};a("220b"),a=a("2877"),a=Object(a.a)(l,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"customer"},[e("el-form",{ref:"formValidate",attrs:{model:t.formValidate,"label-width":"80px",inline:""},nativeOn:{submit:function(t){t.preventDefault()}}},[e("el-form-item",{attrs:{label:"搜索用户："}},[e("el-input",{staticClass:"form_content_width",attrs:{clearable:"",placeholder:"请输入用户UID、昵称或手机号"},model:{value:t.formValidate.nickname,callback:function(e){t.$set(t.formValidate,"nickname",e)},expression:"formValidate.nickname"}})],1),e("el-form-item",[e("el-button",{attrs:{type:"primary"},on:{click:t.userSearchs}},[t._v("查询")])],1)],1),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading2,expression:"loading2"}],ref:"selection",staticClass:"mt15",attrs:{"highlight-current-row":"","no-userFrom-text":"暂无数据","no-filtered-userFrom-text":"暂无筛选结果",data:t.tableList2,height:"450"}},[e("el-table-column",{attrs:{width:"50"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-radio",{attrs:{disabled:!!a.row.is_del,label:a.row.uid},on:{input:function(){return t.currentidRadio(a.row)}},model:{value:t.currentid,callback:function(e){t.currentid=e},expression:"currentid"}},[t._v(" ")])]}}])}),e("el-table-column",{attrs:{label:"UID",width:"80"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",[t._v(t._s(a.row.uid))])]}}])}),e("el-table-column",{attrs:{label:"用户头像","min-width":"90"},scopedSlots:t._u([{key:"default",fn:function(t){return[e("div",{directives:[{name:"viewer",rawName:"v-viewer"}],staticClass:"tabBox_img"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.row.headimgurl,expression:"scope.row.headimgurl"}]})])]}}])}),e("el-table-column",{attrs:{label:"用户昵称","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v(t._s(a.row.nickname))]),e("div",{staticStyle:{color:"red"}},[t._v(t._s(a.row.is_del?"用户已注销":""))])]}}])}),e("el-table-column",{attrs:{label:"手机号","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v(t._s(a.row.phone))])]}}])}),e("el-table-column",{attrs:{label:"是否关注公众号","min-width":"130"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{domProps:{textContent:t._s(1===a.row.subscribe?"关注":"未关注")}})]}}])}),e("el-table-column",{attrs:{label:"注册时间","min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",[t._v(t._s(a.row.add_time))])]}}])})],1),e("div",{staticClass:"acea-row row-right page"},[t.total2?e("pagination",{attrs:{total:t.total2,page:t.formValidate.page,limit:t.formValidate.limit},on:{"update:page":function(e){return t.$set(t.formValidate,"page",e)},"update:limit":function(e){return t.$set(t.formValidate,"limit",e)},pagination:t.getListService}}):t._e()],1)],1)}),[],!1,null,"986dc27e",null);e.default=a.exports},"94b8":function(t,e,a){},ed2f:function(t,e,a){"use strict";a.r(e),a("b0c0");var i=a("5530"),s=(a("b64b"),a("e9c4"),a("4de4"),a("d3b7"),a("a434"),a("d81d"),a("14d9"),a("498a"),a("2f62")),r=a("0f0e"),l=a("c4ad"),o=a("c42b"),n=a("c4c8"),c=a("c24f"),d=a("90e7"),m=a("d708"),u=a("c276"),f=a("8c03"),h=a("ed08");l={name:"storeCouponCreate",components:{goodsList:l.default,newsCategory:o.a,customerInfo:f.default,userLabel:r.a},data:function(){return{customerShow:!1,labelShow:!1,disabled:!1,maxCols:4,labelSelect:[],scrollerHeight:"600",contentTop:"10",contentWidth:"98%",formatImg:["jpg","jpeg","png","bmp","gif"],formatVoice:["mp3","wma","wav","amr"],header:{},fileUrl:m.a.apiBaseURL+"/file/upload/1",formData:{name:"",type:"text",time:void 0,label_id:[],image:"",cate_id:"",content:{content:"",src:"",list:{}}},labelSort:[],isReceiveTime:0,modals:!1,ruleValidate:{name:[{required:!0,message:"请填写二维码名称",trigger:"blur"}],cate_id:[{required:!0,message:"请选择二维码分组",trigger:"change"}]},id:0,dataLabel:[],loading:!1}},computed:Object(i.a)({},Object(s.d)("media",["isMobile"])),created:function(){this.getUserLabelAll(),this.userLabel(),this.getToken(),this.$route.query.id&&(this.id=this.$route.query.id,this.getDetail())},methods:{beforeUpload:function(t){return Object(h.b)(t)},activeData:function(t){this.labelShow=!1,this.dataLabel=t},labelClose:function(){this.labelShow=!1},openLabel:function(t){this.labelShow=!0,this.dataLabel.length&&this.$refs.userLabel.userLabel(JSON.parse(JSON.stringify(this.dataLabel)))},closeLabel:function(t){var e=this.dataLabel.indexOf(this.dataLabel.filter((function(e){return e.id==t.id}))[0]);this.dataLabel.splice(e,1)},getDetail:function(){var t=this;Object(d.Wb)(this.id).then((function(e){t.formData=e.data,0<e.data.time&&(t.isReceiveTime=1),e.data.label_id.length&&(t.dataLabel=e.data.label_id)}))},customer:function(){this.customerShow=!0},addLabel:function(){var t=this;this.$modalForm(Object(c.M)(0)).then((function(){return t.userLabel()}))},userLabel:function(){var t=this;Object(n.n)().then((function(e){t.labelSelect=e.data.list})).catch((function(e){t.$message.error(e.msg)}))},imageObject:function(t){this.customerShow=!1,this.formData.uid=t.uid,this.formData.avatar=t.image},getCentList:function(t){this.formData.content.list=t.new[0],this.modals=!1},delContent:function(){this.formData.content.list={}},handleSuccess:function(t,e){200===t.status?(this.formData.content.src=t.data.src,this.$message.success(t.msg)):this.$message.error(t.msg)},handleFormatError:function(t){"image"===this.formData.type?this.$message.warning("请上传bmp/png/jpeg/jpg/gif格式的图片"):this.$message.warning("请上传mp3/wma/wav/amr格式的语音")},handleMaxSize:function(t){this.$message.warning("请上传文件2M以内的文件")},getToken:function(){this.header["Authori-zation"]="Bearer "+Object(u.c)("token")},selectMenu:function(t){this.formData.type=t},getUserLabelAll:function(){var t=this;Object(d.ac)().then((function(e){e=e.data.data,t.labelSort=e}))},save:function(){var t=this;if(!this.formData.name)return this.$message.error("请输入二维码名称");if(!this.formData.cate_id)return this.$message.error("请选择分组");if(!this.dataLabel.length)return this.$message.error("请选择用户标签");var e=[];if(this.dataLabel.map((function(t){e.push(t.id)})),this.formData.label_id=e,!this.formData.uid)return this.$message.error("请选择推广员");if(this.isReceiveTime){if(this.formData.time<1)return this.$message.error("使用有效期限不能小于1天")}else this.formData.time=0;return"text"!==this.formData.type&&"url"!==this.formData.type||this.formData.content.content.trim()?"voice"!==this.formData.type&&"image"!==this.formData.type||this.formData.content.src.trim()?"news"!==this.formData.type||this.formData.content.list.title.trim()?(this.disabled=!1,this.loading=!0,void Object(d.Yb)(this.id,this.formData).then((function(e){t.disabled=!0,t.$message.success(e.msg),setTimeout((function(){t.$router.push({path:t.$routeProStr+"/marketing/channel_code/channelCodeIndex"})}),1e3)})).catch((function(e){t.disabled=!0,t.$message.error(e.msg)}))):this.$message.error("请选择图文消息"):this.$message.error("请先上传消息"):this.$message.error("请输入内容")}}},a("f1bc"),o=a("2877"),f=Object(o.a)(l,(function(){var t=this,e=t._self._c;return e("div",[e("pages-header",{ref:"pageHeader",attrs:{title:t.$route.meta.title,backUrl:t.$routeProStr+"/marketing/channel_code/channelCodeIndex"}}),e("el-card",{staticClass:"mt16",attrs:{bordered:!1,shadow:"never"}},[e("el-form",{attrs:{model:t.formData,"label-width":"100px",rules:t.ruleValidate}},[e("el-form-item",{attrs:{label:"二维码名称："}},[e("el-input",{staticClass:"content_width",attrs:{clearable:"",placeholder:"请输入二维码名称"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),e("el-form-item",{attrs:{label:"二维码分组："}},[e("el-select",{staticClass:"content_width",attrs:{clearable:""},model:{value:t.formData.cate_id,callback:function(e){t.$set(t.formData,"cate_id",e)},expression:"formData.cate_id"}},t._l(t.labelSort,(function(t,a){return e("el-option",{key:a,attrs:{value:t.id,label:t.cate_name}})})),1)],1),e("el-form-item",{attrs:{label:"用户标签："}},[e("div",{staticStyle:{display:"flex"}},[e("div",{staticClass:"labelInput acea-row row-between-wrapper",on:{click:t.openLabel}},[e("div",{staticStyle:{width:"90%"}},[t.dataLabel.length?e("div",t._l(t.dataLabel,(function(a,i){return e("el-tag",{key:i,attrs:{closable:""},on:{close:function(e){return t.closeLabel(a)}}},[t._v(t._s(a.label_name))])})),1):e("span",{staticClass:"span"},[t._v("选择用户关联标签")])]),e("div",{staticClass:"ivu-icon ivu-icon-ios-arrow-down"})]),e("span",{staticClass:"addfont",on:{click:t.addLabel}},[t._v("新增标签")])])]),e("el-form-item",{attrs:{label:"关联推广员："}},[e("div",{staticClass:"picBox",on:{click:t.customer}},[t.formData.avatar?e("div",{staticClass:"pictrue"},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.formData.avatar,expression:"formData.avatar"}]})]):e("div",{staticClass:"upLoad acea-row row-center-wrapper"},[e("i",{staticClass:"el-icon-user",staticStyle:{"font-size":"24px"}})])]),e("div",{staticClass:"trip"},[t._v("扫码注册的新用户,将自动成为此推广员的下级,与分销推广功能一致")])]),e("el-form-item",{attrs:{label:"有效期："}},[e("el-radio-group",{model:{value:t.isReceiveTime,callback:function(e){t.isReceiveTime=e},expression:"isReceiveTime"}},[e("el-radio",{attrs:{label:0}},[t._v("永久")]),e("el-radio",{attrs:{label:1}},[t._v("有效期")])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isReceiveTime,expression:"isReceiveTime"}]},[e("el-input-number",{staticClass:"content_width",attrs:{controls:!1,max:1e4,precision:0,placeholder:"请输入天数"},model:{value:t.formData.time,callback:function(e){t.$set(t.formData,"time",e)},expression:"formData.time"}}),t._v("\n          天\n        ")],1),e("div",{staticClass:"trip"},[t._v("临时码过期后不能再扫码,永久二维码最大创建数量为10万个")])],1),e("el-form-item",{attrs:{label:"回复内容："}},[e("el-radio-group",{model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},[e("el-radio",{attrs:{label:"text"}},[t._v("文字内容")]),e("el-radio",{attrs:{label:"voice"}},[t._v("声音消息")]),e("el-radio",{attrs:{label:"image"}},[t._v("图片消息")]),e("el-radio",{attrs:{label:"news"}},[t._v("图文消息")])],1)],1),"text"===t.formData.type||"url"===t.formData.type?e("el-form-item",{attrs:{label:"消息内容：",prop:"content"}},[e("el-input",{staticClass:"content_width",attrs:{type:"textarea",rows:"2",clearable:"",placeholder:"text"===t.formData.type?"请填写消息内容":"请填写网址链接"},model:{value:t.formData.content.content,callback:function(e){t.$set(t.formData.content,"content",e)},expression:"formData.content.content"}})],1):t._e(),"news"===t.formData.type?e("el-form-item",{attrs:{label:"选取图文："}},[e("el-button",{on:{click:function(e){t.modals=!0}}},[t._v("选择图文消息")]),t.formData.content.list.title?e("div",{staticClass:"news-box"},[e("img",{staticClass:"news_pic",attrs:{src:t.formData.content.list.image_input[0]}}),e("span",[t._v(t._s(t.formData.content.list.title))]),e("i",{staticClass:"el-icon-error del_icon",on:{click:t.delContent}})]):t._e()],1):t._e(),"image"===t.formData.type||"voice"===t.formData.type?e("el-form-item",{attrs:{label:"image"===t.formData.type?"图片地址：":"语音地址：",prop:"src"}},[e("div",{staticClass:"acea-row row-middle"},[e("el-input",{staticClass:"content_width mr15",attrs:{readonly:"readonly",placeholder:"请填入链接地址"},model:{value:t.formData.content.src,callback:function(e){t.$set(t.formData.content,"src",e)},expression:"formData.content.src"}}),e("el-upload",{staticClass:"mr20",staticStyle:{"margin-top":"1px"},attrs:{"show-file-list":!1,action:t.fileUrl,"on-success":t.handleSuccess,format:"image"===t.formData.type?t.formatImg:t.formatVoice,"max-size":2048,headers:t.header,"on-format-error":t.handleFormatError,"on-exceeded-size":t.handleMaxSize,accept:"image/*","before-upload":t.beforeUpload}},[e("el-button",{attrs:{type:"primary"}},[t._v("上传")])],1)],1),e("span",{directives:[{name:"show",rawName:"v-show",value:"image"===t.formData.type,expression:"formData.type === 'image'"}]},[t._v("文件最大2Mb，支持bmp/png/jpeg/jpg/gif格式")]),e("span",{directives:[{name:"show",rawName:"v-show",value:"voice"===t.formData.type,expression:"formData.type === 'voice'"}]},[t._v("文件最大2Mb，支持mp3格式,播放长度不超过60s")])]):t._e()],1),e("el-button",{staticClass:"submit",attrs:{type:"primary",loading:t.loading,disabled:t.disabled},on:{click:t.save}},[t._v("立即提交")])],1),e("el-dialog",{attrs:{visible:t.customerShow,title:"请选择商城用户","show-close":!0,width:"1000px"},on:{"update:visible":function(e){t.customerShow=e}}},[t.customerShow?e("customerInfo",{on:{imageObject:t.imageObject}}):t._e()],1),e("el-dialog",{staticClass:"modelBox",attrs:{visible:t.modals,title:"发送消息",width:"1200px"},on:{"update:visible":function(e){t.modals=e}}},[t.modals?e("news-category",{attrs:{scrollerHeight:t.scrollerHeight,contentTop:t.contentTop,contentWidth:t.contentWidth,maxCols:t.maxCols},on:{getCentList:t.getCentList}}):t._e()],1),e("el-dialog",{attrs:{visible:t.labelShow,scrollable:"",title:"请选择用户标签",closable:!1,width:"540px","footer-hide":!0,"mask-closable":!1},on:{"update:visible":function(e){t.labelShow=e}}},[e("userLabel",{ref:"userLabel",on:{activeData:t.activeData,close:t.labelClose}})],1)],1)}),[],!1,null,"13144555",null);e.default=f.exports},f1bc:function(t,e,a){"use strict";a("7db8")}}]);